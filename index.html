<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8" />
    <title>Karakter Katalogu</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, user-scalable=yes" />
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />
    <link rel="stylesheet" href="styles.css" />
</head>
<body>
    <!-- Toast Bildirimleri -->
    <div id="toast-container" class="toast-container"></div>
    
    <!-- Admin Chat Panel -->
    <div id="chat-panel" class="chat-panel hidden">
        <div class="chat-panel-header">
            <h3>Admin Chat</h3>
            <button id="chat-close-btn" class="btn subtle" style="padding: 4px 8px; font-size: 18px;">√ó</button>
        </div>
        <div id="chat-messages" class="chat-messages">
            <!-- Mesajlar buraya eklenecek -->
        </div>
        <div class="chat-input-container">
            <input type="text" id="chat-message-input" placeholder="Mesajƒ±nƒ±zƒ± yazƒ±n..." maxlength="500" />
            <button id="chat-send-btn" class="btn primary">G√∂nder</button>
        </div>
    </div>
    
    <div id="app">

        <!-- Gƒ∞Rƒ∞≈û EKRANI -->
        <section id="login-screen" class="screen">
            <div class="card card-login">
                <h1>Proje Katalog Giri≈üi</h1>
                <form id="login-form">
                    <label>
                        Kullanƒ±cƒ± Adƒ±
                        <input type="text" id="username" autocomplete="username" required />
                    </label>
                    <label>
                        ≈ûifre
                        <input type="password" id="password" autocomplete="current-password" required />
                    </label>
                    <div style="margin-top: 20px;">
                        <button type="submit" class="btn primary">Giri≈ü Yap</button>
                    </div>
                    <p id="login-error" class="error-message"></p>
                </form>
            </div>
        </section>

        <!-- ANA EKRAN -->
        <section id="main-screen" class="screen hidden">
            <header class="topbar">
                <div class="topbar-left">
                    <h1>Character Gallery</h1>
                    <span id="current-user-info" class="pill"></span>
                </div>
                <div class="topbar-right" style="display: flex; gap: 8px; align-items: center;">
                    <button id="blur-toggle-btn" class="btn subtle" title="G√∂rselleri Bulanƒ±kla≈ütƒ±r">üëÅÔ∏è</button>
                    <button id="theme-toggle-btn" class="btn subtle" title="Tema Deƒüi≈ütir">üåì</button>
                    <button id="chat-toggle-btn" class="btn subtle" title="Admin Chat" style="display: none;">üí¨</button>
                    <button id="users-management-btn" class="btn subtle" style="display: none;">Kullanƒ±cƒ± Y√∂netimi</button>
                    <button id="logout-btn" class="btn subtle">√áƒ±kƒ±≈ü</button>
                </div>
            </header>

            <main class="two-column-layout">
                <!-- SOL S√úTUN: PROJE + KARAKTER Lƒ∞STESƒ∞ -->
                <aside class="left-column">
                    <!-- PROJE Lƒ∞STESƒ∞ -->
                    <div class="projects-section">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <h2 style="margin: 0; font-size: 16px; font-weight: 600;">Projeler</h2>
                            <button id="add-project-btn" class="btn primary" style="font-size: 12px; padding: 4px 8px; display: none;">
                                + Ekle
                            </button>
                        </div>
                        <div id="project-list" class="project-accordion">
                            <!-- JS ile doldurulacak -->
                        </div>
                    </div>

                    <!-- KARAKTER Lƒ∞STESƒ∞ (Se√ßili proje altƒ±nda) -->
                    <div id="characters-sidebar-section" class="characters-sidebar-section hidden">
                        <div class="characters-sidebar-header">
                            <h3 id="sidebar-project-title" style="margin: 0; font-size: 14px; font-weight: 600;"></h3>
                            <div class="characters-sidebar-actions">
                                <input type="text" id="character-search-input" placeholder="Ara..." class="search-input" />
                                <button id="add-character-sidebar-btn" class="btn primary" style="font-size: 12px; padding: 4px 8px; display: none;">
                                    + Karakter
                                </button>
                            </div>
                        </div>
                        <div id="character-filters" class="character-filters" style="display: none;">
                            <!-- Filtreler buraya eklenecek -->
                        </div>
                        <ul id="characters-sidebar-list" class="characters-sidebar-list">
                            <!-- JS ile doldurulacak -->
                        </ul>
                    </div>
                </aside>

                <!-- SAƒû S√úTUN: KARAKTER DETAY PANELƒ∞ -->
                <section class="right-column">
                    <div id="character-detail-panel" class="character-detail-panel">
                        <!-- Bo≈ü durum -->
                        <div id="empty-state" class="empty-state">
                            <div class="empty-state-icon">üë§</div>
                            <h3>Karakter Se√ßilmedi</h3>
                            <p>Sol taraftan bir karakter se√ßin veya yeni bir karakter ekleyin.</p>
                        </div>

                        <!-- Karakter Detay ƒ∞√ßeriƒüi (gizli ba≈ülangƒ±√ßta) -->
                        <div id="character-detail-content" class="character-detail-content hidden">
                            <!-- Hero Alanƒ± -->
                            <div class="character-detail-hero">
                                <div class="character-detail-avatar-wrapper">
                                    <img id="detail-main-image" src="" alt="Ana g√∂rsel" />
                                    <button id="set-main-image-btn" class="btn subtle" style="display: none; position: absolute; bottom: 8px; right: 8px; font-size: 11px;">
                                        Ana G√∂rsel
                                    </button>
                                </div>
                                <div class="character-detail-hero-info">
                                    <h2 id="detail-full-name" class="character-name-display"></h2>
                                    <div id="detail-meta" class="character-meta-display"></div>
                                    <div id="detail-project-badge" class="project-badge"></div>
                                </div>
                            </div>

                            <!-- Traits Alanƒ± -->
                            <div class="character-traits-section">
                                <div class="section-header">
                                    <h3>Karakteristik √ñzellikler</h3>
                                    <button id="edit-traits-btn" class="btn subtle" style="display: none; font-size: 12px;">D√ºzenle</button>
                                </div>
                                <div id="traits-display" class="traits-display"></div>
                                <div id="traits-edit" class="traits-edit hidden">
                                    <textarea id="traits-textarea" rows="4" placeholder="Karakteristik √∂zellikler..."></textarea>
                                </div>
                            </div>

                            <!-- Resim Kataloƒüu -->
                            <div class="character-images-section">
                                <div class="section-header">
                                    <h3>Resim Kataloƒüu</h3>
                                    <div class="section-actions">
                                        <div id="tag-filters" class="tag-filters">
                                            <!-- Tag filtreleri buraya eklenecek -->
                                        </div>
                                        <button id="add-image-btn-panel" class="btn primary" style="display: none; font-size: 12px;">
                                            + Resim Ekle
                                        </button>
                                    </div>
                                </div>
                                <div id="character-images-grid" class="character-images-grid">
                                    <!-- JS ile doldurulacak -->
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </main>
        </section>

        <!-- PROJE EKLE / D√úZENLE MODALI -->
        <div id="project-modal" class="modal hidden">
            <div class="modal-backdrop" id="project-modal-backdrop"></div>
            <div class="modal-content">
                <h3 id="project-modal-title">Yeni Proje</h3>
                <form id="project-form">
                    <label>
                        Proje Adƒ±
                        <input type="text" id="project-name" required />
                    </label>
                    <label>
                        A√ßƒ±klama
                        <textarea id="project-description" rows="3" placeholder="Proje hakkƒ±nda kƒ±sa a√ßƒ±klama..."></textarea>
                    </label>
                    <div class="modal-actions">
                        <button type="button" id="discard-project-btn" class="btn subtle">
                            Discard
                        </button>
                        <button type="submit" class="btn primary">
                            Save
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- KARAKTER DETAY EKRANI -->
        <section id="character-detail-screen" class="screen hidden">
            <header class="topbar">
                <div class="topbar-left">
                    <button id="back-to-list-btn" class="btn subtle" style="margin-right: 12px;">‚Üê Geri</button>
                    <h1 id="character-detail-name">Karakter Detayƒ±</h1>
                </div>
                <div class="topbar-right">
                    <button id="edit-character-btn" class="btn primary" style="display: none;">D√ºzenle</button>
                    <button id="logout-btn-2" class="btn subtle">√áƒ±kƒ±≈ü</button>
                </div>
            </header>

            <main class="character-detail-content">
                <div class="character-detail-header">
                    <div class="character-detail-main-image-wrapper">
                        <img id="character-detail-main-image" src="" alt="Ana g√∂rsel" />
                    </div>
                    <div class="character-detail-info">
                        <h2 id="character-detail-full-name"></h2>
                        <div id="character-detail-meta"></div>
                        <div id="character-detail-traits"></div>
                    </div>
                </div>

                <div class="character-images-section">
                    <div class="section-header">
                        <h3>Resim Kataloƒüu</h3>
                        <button id="add-image-btn" class="btn primary" style="display: none;">+ Resim Ekle</button>
                    </div>
                    <div id="character-images-grid" class="character-images-grid">
                        <!-- JS ile doldurulacak -->
                    </div>
                </div>
            </main>
        </section>

        <!-- KARAKTER EKLE / D√úZENLE MODALI -->
        <div id="character-modal" class="modal hidden">
            <div class="modal-backdrop" id="character-modal-backdrop"></div>
            <div class="modal-content">
                <h3 id="character-modal-title">Yeni Karakter</h3>
                <form id="character-form">
                    <div class="form-row">
                        <label>
                            ƒ∞sim
                            <input type="text" id="char-first-name" required />
                        </label>
                        <label>
                            Soyisim
                            <input type="text" id="char-last-name" required />
                        </label>
                    </div>

                    <label>
                        Karakteristik √ñzellikler
                        <textarea id="char-traits" rows="3" placeholder="Kƒ±sa a√ßƒ±klama..."></textarea>
                    </label>

                    <div class="form-row">
                        <label>
                            Burcu
                            <input type="text" id="char-zodiac" />
                        </label>
                        <label>
                            Ya≈ü
                            <input type="number" id="char-age" min="0" />
                        </label>
                    </div>

                    <label>
                        Karakter Resmi
                        <input type="file" id="char-image" accept="image/*" />
                        <span class="form-error" id="char-image-error"></span>
                        <small style="color: var(--text-muted); font-size: 12px;">Maksimum dosya boyutu: 5MB</small>
                    </label>

                    <div class="image-preview" id="char-image-preview-wrapper">
                        <img id="char-image-preview" alt="√ñnizleme" />
                    </div>

                    <div class="modal-actions">
                        <button type="button" id="discard-character-btn" class="btn subtle">
                            Discard
                        </button>
                        <button type="submit" class="btn primary">
                            Save
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- RESƒ∞M EKLE / D√úZENLE MODALI -->
        <div id="image-modal" class="modal hidden">
            <div class="modal-backdrop" id="image-modal-backdrop"></div>
            <div class="modal-content">
                <h3 id="image-modal-title">Yeni Resim</h3>
                <form id="image-form">
                    <label>
                        Resim Ba≈ülƒ±ƒüƒ±
                        <input type="text" id="image-title" required />
                    </label>
                    <label>
                        A√ßƒ±klama
                        <textarea id="image-description" rows="2"></textarea>
                    </label>
                    <label>
                        Positive Prompt
                        <textarea id="image-positive-prompt" rows="3" placeholder="AI i√ßin pozitif prompt (opsiyonel)"></textarea>
                    </label>
                    <label>
                        Negative Prompt
                        <textarea id="image-negative-prompt" rows="3" placeholder="AI i√ßin negatif prompt (opsiyonel)"></textarea>
                    </label>
                    <label>
                        Etiketler (virg√ºlle ayƒ±rƒ±n)
                        <input type="text" id="image-tags" placeholder="sprite, cg, battle" />
                    </label>
                    <label>
                        Resim Dosyasƒ±
                        <input type="file" id="image-file" accept="image/*" required />
                        <span class="form-error" id="image-file-error"></span>
                        <small style="color: var(--text-muted); font-size: 12px;">Maksimum dosya boyutu: 5MB</small>
                    </label>
                    <div class="image-preview" id="image-preview-wrapper">
                        <img id="image-preview" alt="√ñnizleme" />
                    </div>
                    <div class="modal-actions">
                        <button type="button" id="discard-image-btn" class="btn subtle">
                            Discard
                        </button>
                        <button type="submit" class="btn primary">
                            Save
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- RESƒ∞M √ñNƒ∞ZLEME MODALI (CAROUSEL) -->
        <div id="image-view-modal" class="modal hidden">
            <div class="modal-backdrop" id="image-view-modal-backdrop"></div>
            <div class="modal-content image-carousel-modal">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                    <button id="prev-image-btn" class="btn subtle" style="display: none;">‚Üê √ñnceki</button>
                    <button id="close-image-view-btn" class="btn subtle">√ó Kapat</button>
                    <button id="next-image-btn" class="btn subtle" style="display: none;">Sonraki ‚Üí</button>
                </div>
                <div id="image-carousel-container" class="image-carousel-container">
                    <div id="image-carousel-track" class="image-carousel-track">
                        <!-- JS ile doldurulacak -->
                    </div>
                </div>
                <div id="image-view-info" style="margin-top: 20px; text-align: center;">
                    <h4 id="image-view-title"></h4>
                    <p id="image-view-description"></p>
                    <div id="image-view-tags"></div>
                    <div id="image-view-prompts" style="margin-top: 12px; text-align: left; max-width: 600px; margin-left: auto; margin-right: auto;"></div>
                    <div id="image-carousel-indicator" style="margin-top: 12px; font-size: 12px; color: var(--text-muted);"></div>
                    <div id="image-view-actions" style="margin-top: 16px; display: flex; gap: 8px; justify-content: center; flex-wrap: wrap;">
                        <button id="delete-image-from-view-btn" class="btn subtle" style="display: none; color: var(--danger); border-color: var(--danger);">
                            üóëÔ∏è Resmi Sil
                        </button>
                        <button id="reorder-images-in-view-btn" class="btn subtle" style="display: none; color: var(--accent); border-color: var(--accent);">
                            ‚ÜïÔ∏è Sƒ±ralamayƒ± Deƒüi≈ütir
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- KULLANICI Y√ñNETƒ∞Mƒ∞ EKRANI -->
        <section id="users-management-screen" class="screen hidden">
            <header class="topbar">
                <div class="topbar-left">
                    <button id="back-to-main-btn" class="btn subtle" style="margin-right: 12px;">‚Üê Geri</button>
                    <h1>Kullanƒ±cƒ± Y√∂netimi</h1>
                </div>
                <div class="topbar-right">
                    <button id="add-user-btn" class="btn primary">+ Kullanƒ±cƒ± Ekle</button>
                    <button id="logout-btn-3" class="btn subtle">√áƒ±kƒ±≈ü</button>
                </div>
            </header>

            <main class="content" style="padding: 16px;">
                <div id="users-list" class="users-list">
                    <!-- JS ile doldurulacak -->
                </div>
            </main>
        </section>

        <!-- KULLANICI EKLE / D√úZENLE MODALI -->
        <div id="user-modal" class="modal hidden">
            <div class="modal-backdrop" id="user-modal-backdrop"></div>
            <div class="modal-content">
                <h3 id="user-modal-title">Yeni Kullanƒ±cƒ±</h3>
                <form id="user-form">
                    <label>
                        Kullanƒ±cƒ± Adƒ±
                        <input type="text" id="user-username" required />
                    </label>
                    <label>
                        ≈ûifre
                        <input type="password" id="user-password" />
                        <small style="color: var(--text-muted); font-size: 12px;">D√ºzenleme sƒ±rasƒ±nda bo≈ü bƒ±rakƒ±rsanƒ±z ≈üifre deƒüi≈ümez</small>
                    </label>
                    <label>
                        Rol
                        <select id="user-role" required>
                            <option value="user">User</option>
                            <option value="admin">Admin</option>
                        </select>
                    </label>
                    <label>
                        Projeler (virg√ºlle ayƒ±rƒ±n, proje ID'leri)
                        <input type="text" id="user-projects" placeholder="proje-1, proje-2" />
                        <small style="color: var(--text-muted); font-size: 12px;">Kullanƒ±cƒ±nƒ±n eri≈üebileceƒüi proje ID'lerini virg√ºlle ayƒ±rarak girin</small>
                    </label>
                    <div class="modal-actions">
                        <button type="button" id="discard-user-btn" class="btn subtle">
                            Discard
                        </button>
                        <button type="submit" class="btn primary">
                            Save
                        </button>
                    </div>
                </form>
            </div>
        </div>

    </div>

    <script src="app.js"></script>
</body>
</html>
